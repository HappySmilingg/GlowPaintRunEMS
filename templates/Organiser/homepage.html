<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Glow Paint Run</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='or_homepage.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='header&footer.css')}}">
    <!-- Icon lib -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Irish Grover (for title) -->
    <link href="https://fonts.googleapis.com/css2?family=Irish+Grover&display=swap" rel="stylesheet">
    <!-- Inter text (for content) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
  
<body>
    <div class="flash-message-container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message alert alert-{{ category }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>
  <div class="header">
    <div class="hamburger" onclick="toggleMenu()">&#9776;</div>
    <div class="header-structure-left">
        <div class="header-item active" onclick="window.location.href='/Organiser/homepage'">Dashboard</div>
        <div class="header-item">Participant
            <i class="fa fa-caret-down"></i>
            <ul class="header-subitem">
                <li><a href="#" onclick="window.location.href='/Organiser/student_participant_list'">USM Student</a></li>
                <li><a href="#" onclick="window.location.href='/Organiser/public_participant_list'">Public</a></li>
            </ul>
        </div>
        <div class="header-item" onclick="window.location.href='/Organiser/info_list'">Event Route</div>
        <div class="header-item">About Us
            <i class="fa fa-caret-down"></i>
            <ul class="header-subitem">
                <li><a href="#" onclick="window.location.href='/Organiser/about_us'">About Us</a></li>
                <li><a href="#" onclick="window.location.href='/Organiser/contact_us'">Contact Us</a></li>
            </ul>
        </div>
        </div>
        <div class="header-structure-right">
            <div class="login-btn" onclick="window.location.href='/Organiser/login'">
                <i class='fas fa-power-off'></i>
                <div class="login-text">Log Out</div>
            </div>
        </div>
    </div> 
    <div class="containers">
    <form method="POST" enctype="multipart/form-data" action="/Organiser/homepage">
        <button type="submit" class="save-btn">Save Changes</button>
    <div class="past-event-container">
        <div class="past-event-section">
            <div class="text4">Past Event</div>
            <div class="carousel">
                {% for i in range(1, 6) %}
                <div class="item">
                    <img class="carousel-image" src="data:image/png;base64,{{ images[i].picture }}" alt="Past Event Image">
                    <div class="upload-container">
                        <label for="upload-image-{{ i }}" class="upload-btn">UPLOAD NEW IMAGE</label>
                        <input type="file" id="upload-image-{{ i }}" name="upload-image-{{ i }}" accept="image/png, image/jpeg" style="display: none;">
                    </div>
                </div>
                {% endfor %}
            </div>             
        </div>
    </div>
    </form>
    </div>
  </body>
</html>

<script>
    // The top menu effect function
    const header = document.querySelector('.header');
  
    // Add scroll event listener
    window.addEventListener('scroll', () => {
      if (window.scrollY > 0) {
        header.classList.add('shrink');
      } else {
        header.classList.remove('shrink');
      }
    });

    function toggleMenu() {
        const leftStructure = document.querySelector('.header-structure-left');
        const rightStructure = document.querySelector('.header-structure-right');
        leftStructure.classList.toggle('menu-open'); // Toggle the visibility of the left structure
        rightStructure.classList.toggle('menu-open'); // Toggle the visibility of the right structure
    }

    // Function to handle image preview
    function setupImageUpload(inputId, imgSelector) {
        const input = document.getElementById(inputId);
        input.addEventListener('change', function () {
            const file = this.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    // Update the image preview
                    document.querySelector(imgSelector).src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
    }

    // Set up image upload previews for all inputs
    document.addEventListener('DOMContentLoaded', function () {
    for (let i = 1; i <= 5; i++) {
        setupImageUpload(
            `upload-image-${i}`, 
            `.carousel .item:nth-child(${i}) img.carousel-image`
        );
    }
});

document.addEventListener('DOMContentLoaded', function () {
    setTimeout(function () {
        const flashMessages = document.querySelectorAll('.flash-message');
        flashMessages.forEach((msg) => {
            // Fade out effect
            msg.style.transition = 'opacity 0.5s ease';
            msg.style.opacity = '0';
            setTimeout(() => {
                msg.remove(); // Remove after fade out
            }, 500);
            });
        }, 3000); // Display for 3 seconds
    });
</script>